# Q1 ======================================================
x <- c(14,18,2,4,-5,14,-3,-1,1,6,3,3)
y <- c(8,26,-7,-1,2,9,0,-4,13,3,3,4)
# method 1
diff <- x-y
T0 <- (mean(diff)/(sd(diff)/sqrt(length(diff))))
(1-pt(T0,length(diff)-1))*2
qt(0.975,length(diff)-1)
# method 2
t.test(x,y,paired = T)

# Q2 ======================================================
x <- c(60,39,64,54,70,50,67,65,35,62,73,89,86,80,65,74,73)
y <- c(41,92,83,65,60,91,52,76,78,69,60,54,84,65)
var.test(x,y,conf.level = 0.9)
t.test(x,y,conf.level = 0.95,var.equal = T)

# Q3 ======================================================
p1 <- 0.46; n1 <- 66
p2 <- 0.64; n2 <- 109
p <- (p1*n1+p2*n2)/(n1+n2)
test <- (p1-p2)/sqrt(p*(1-p)/n1+p*(1-p)/n2)
(p1-p2) - 1.96*sqrt(p*(1-p)/n1+p*(1-p)/n2)
(p1-p2) + 1.96*sqrt(p*(1-p)/n1+p*(1-p)/n2)

# Q4 ======================================================
n1 <- 172; x1 <- 35.33; s1 <- 2.834; p1 <- 0.7
n2 <- 197; x2 <- 35.15; s2 <- 2.682; p2 <- 0.4
test <- (x1-x2)/sqrt(s1^2/n1 + s2^2/n2)
x1-x2-1.96*sqrt(s1^2/n1 + s2^2/n2)
x1-x2+1.96*sqrt(s1^2/n1 + s2^2/n2)
p <- (p1*n1+p2*n2)/(n1+n2)
test_p <- (p1-p2)/sqrt(p*(1-p)/n1+p*(1-p)/n2)
(p1-p2) - 1.96*sqrt(p*(1-p)/n1+p*(1-p)/n2)
(p1-p2) + 1.96*sqrt(p*(1-p)/n1+p*(1-p)/n2)

# Q5 ======================================================
x <- c(29.9,11.4,25.3,16.5,21.1)
y <- c(26.6,23.7,28.5,14.2,17.9,24.3)
var.test(x,y,conf.level = 0.9)
t.test(x,y,conf.level = 0.95,var.equal = T)