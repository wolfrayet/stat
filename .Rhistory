p <- apply(pdata,2,function(k)sum(gen_p*k))
p
gen_p
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.2,0.4,0.4);n <- 2
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
p<-c(0.2,0.4,0.4)
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
sum(gen_p*k)
p <- apply(pdata,2,function(k)sum(gen_p*k))
p
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
p <- apply(pdata,2,function(k)sum(gen_p*k))
p
gen_p*k
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.2,0.4,0.4)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.2,0.4,0.4)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
0.1225^2+2*0.1225*0.455/2+0.455*0.455/4
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.12,0.36,0.52)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
p
pdata
apply(pdata,2,function(k)sum(gen_p*k))
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
apply(pdata,2,function(k)sum(gen_p*k))
p
p<-apply(pdata,2,function(k)sum(gen_p*k))
p
p<-apply(pdata,2,function(k)sum(gen_p*k))
apply(pdata,2,function(k)sum(gen_p*k))
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
gen_p
pdata
apply(pdata,2,sum)
apply(pdata,2,fun(k)sum(k))
apply(pdata,2,function(k)sum(k))
g <- c(1,2,3,4,5)
apply(pdata,2,function(k)sum(k*g))
g <- c(1,2,3,4,5,6)
apply(pdata,2,function(k)sum(k*g))
g <- c(1,2,3,4,5,6)
g<-g*2
g
apply(pdata,2,function(k)sum(k*g))
p
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
p
pdata
p<-c(0.5,0.4,0.1)
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
gen_p
p <- apply(pdata,2,function(k)sum(gen_p*k))
p
apply(pdata,2,function(k)sum(gen_p*k))
p<-c(0.4,0.4,0.2)
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
p <- apply(pdata,2,function(k)sum(gen_p*k))
p
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
p <- apply(pdata,2,function(k)sum(gen_p*k))
p
apply(pdata,2,function(k)sum(gen_p*k))
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.5,0.4,0.1)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.49,0.42,0.09)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.01,0.97,0.02)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.05,0.85,0.1)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
pdata <- cbind(c(1,0.5,0,0.25,0,0),
c(0,0.5,1,0.5,0.5,0),
c(0,0,0,0.25,0.5,1))
HW <- function(p,n){
if(n!=1){
for(i in 1:(n-1)){
#每一代機會
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
#基因比例
p <- apply(pdata,2,function(k)sum(gen_p*k))
}
}
names(p) <- c("AA","Aa","aa")
p
}
#AA,Aa,aa比例;第二代
p <- c(0.3,0.3,0.4)
#第二代
HW(p,2)
#第三代
HW(p,3)
#第四代
HW(p,4)
#第五代
HW(p,5)
0.2025*pdata[1]
pdata
pdata[1]
pdata[1][]
pdata[1][1]
pdata[2][1]
pdata[][1]
pdata
0.2025*pdata
p
p<-c(0.1225,0.455,0.4225)
p
gen_p <- c(p[1]^2,2*p[1]*p[2],2*p[1]*p[3],p[2]^2,2*p[2]*p[3],p[3]^2)
gen_p
gen_p*pdata
sum(gen_p*pdata,2)
gen_p*pdata[1][1]+gen_p*pdata[2][1]+gen_p*pdata[4][1]
gen_p*pdata[1][1\]
gen_p*pdata[1][1]
gen_p*pdata
p
gen_p
gen_p %*% pdata
gen_p %*% pdata %*% pdata
gen_p %*% (pdata %*% pdata)
gen_p %*% (pdata)
qt(0.95,1)
qt(0.95,5)
qt(0.95,c(1,5,10,100))
qt(0.95,1000)
qt(0.95,10000)
qt(0.95,99999999)
qchisq(0.05,c(1,2,5,10))
qchisq(0.95,c(1,2,5,10))
exp = 4.5
var = 33/40
se = 5 * sqrt(3.5)
1 - pnorm(44.5/se, 0, 1)
exp = 7/2*30
se = sqrt(30*35/12)
1 - pnorm(45.5/se, 0, 1)
1 - pnorm(45/se, 0, 1)
1 - pnorm(44.5/se, 0, 1)
pnorm(24.5/se, 0, 1) - pnorm(-24.5/se, 0, 1)
pnorm(45.5/se, 0, 1)
45.5/se
clear()
clean
clean()
rm(list=ls())
ex = 4.5
var = 33/40
var = (1+4+9+16+25+36+49+64+81)-ex^2
var = (1+4+9+16+25+36+49+64+81)/10-ex^2
var = 33/40
var = (1+4+9+16+25+36+49+64+81)-ex^2
var = (1+4+9+16+25+36+49+64+81)/10-ex^2
var = var/10
se = sqrt(var)
pnorm(0.5/se,0,1)
pnorm(1.5/se,0,1)-pnorm(-0.5/se,0,1)
pnorm(0.55/se,0,1)-pnorm(0.45/se,0,1)
rm(list=ls())
var = 100*0.35*0.65
se = sqrt(var)
qnorm(5/se,0,1)-qnorm(-5/se,0,1)
pnorm(5/se,0,1)-pnorm(-5/se,0,1)
var = 2*var
se = sqrt(var)
pnorm(10/se,0,1)-pnorm(-10/se,0,1)
var = var*5
se = sqrt(var)
pnorm(50/se,0,1)-pnorm(-50/se,0,1)
se = 0.8*0.2/10
pnorm(0.05/se,0,1)-pnorm(-0.05/se,0,1)
qnorm(1-0.4991,0,1)
a = qnorm(1-0.4991,0,1)
a*se+0.8
1-0.4991
0.9982/2
0.05/se
-0.05/se
se = 0.008
pnorm(0.05/se,0,1)-pnorm(-0.05/se,0,1)
-0.05/se
0.05/se
o <- c(315,108,101,32)
e <- sum(o)*c(9/16,3/16,3/16,1/16)
chi = sum((o-e)^2/e^2)
chi = sum((o-e)^2/e)
chi
qchisq(0.95,3)
lambda = 91+64+33+8
dpois(0,lambda)
dpois(1,lambda)
lambda = lambda/280
196/280
dpois(0,lambda)
dpois(1,lambda)
dpois(2,lambda)
dpois(3,lambda)
dpois(4,lambda)
x <- c(dpois(0,lambda),dpois(1,lambda),dpois(2,lambda),dpois(3,lambda),dpois(4,lambda))
x*280
y <- c(144,91,32,11,2)
x <- x*280
sum((y-x)^2/x)
y <- c(1968,1919,2042,1932,2003,2136)
x <- c(2000,2000,2000,2000,2000,2000)
sum((y-x)^2/x)
qchisq(0.95,5)
y <- c(7,9,73,51,80,15,8)
x <- cbind(seq(15,17.5,0.5),18.5)
x
x <- c(seq(15,17.5,0.5),18.5)
cum <- pnorm(x,mean=16.5,sd=1)
p <- c(pnorm(15,16.5,1),diff(cum),1-pnorm(18.5,16.5,1))
e <- sum(y)*p
sum((y-e)^2/e)
x <- c(seq(15,17.5,0.5))
cum <- pnorm(x,mean=16.5,sd=1)
p <- c(pnorm(15,16.5,1),diff(cum),1-pnorm(18.5,16.5,1))
e <- sum(y)*p
sum((y-e)^2/e)
p <- c(pnorm(15,16.5,1),diff(cum),1-pnorm(17.5,16.5,1))
e <- sum(y)*p
sum((y-e)^2/e)
qchisq(0.95,6)
sum(p)
sum(y)
x <- c(seq(15.25,17.75,0.5))
x
cum <- pnorm(x,mean=16.5,sd=1)
p <- c(pnorm(15.25,16.5,1),diff(cum),1-pnorm(17.75,16.5,1))
p
e <- sum(y)*p
e
sum((y-e)^2/e)
sum(p)
y
p
e
mean(y)
value <- (15,15.5,16,16.5,17,17.5,18.5)
value <- c(15,15.5,16,16.5,17,17.5,18.5)
mean(y*value)
y*value
y*value/sum(y)
sum(y*value)/sum(y)
mean(1,2,3,4)
mean(c(1,2,3,4)
)
sum(c(1,2,3,4))/4
avg = sum(y*value)/sum(y)
data <- c(7,9,73,51,80,25,8)
data <- c(7,9,73,51,80,15,8)
avg <- c(15,15.5,16,16.5,17,17.5,18.5)
sum(data*avg)/sum(data)
a = sum(data*avg)/sum(data)
sum(data*(avg-a)^2)/sum(data)
(sum(data*(avg)^2)-a^2)/sum(data)
sum(data*(avg)^2)/sum(data) - a^2
sd = sum(data*(avg)^2)/sum(data) - a^2
cum <- pnorm(seq(15.25,17.75,0.5),mean=a, sd=sd)
p <- c(pnorm(15.25,mean=a,sd=sd),diff(cum),1-pnorm(17.25,mean=a,sd=sd))
p
e <- sum(data) * p
e
sum(data)
p <- c(pnorm(15.25,mean=a,sd=sd),diff(cum),1-pnorm(17.75,mean=a,sd=sd))
p
e <- sum(data) * p
e
sum((data-e)^2/e)
qchisq(0.95,4)
data*avg
sum(data*avg)
a*sum(data)
seq(15.25,17.75,0.5)
sd <- sum(data*avg^2)/sum(data) - a^2
sd
a
a<-1.96*sqrt(7/12*5/12/12)
7/12+a
7/12-a
a<-1.96*sqrt(7/12*5/12/120)
7/12+a
7/12-a
a<-1.96*sqrt(7/12*5/12/240)
7/12-a
7/12+a
qt(0.025,99)
30/11
b<-qt(0.975,99)*0.011
b
0.63+b
0.63-b
(4.5-4.2)/1.1/sqrt(80)
qt(0.025,79)
(4.5-4.2)/(1.1/sqrt(80))
obs<-c(6.36,5.62,5.27,5.46,5.29,5.29,5.39,5.30,5.58,5.44,5.42,5.75,5.65,5.34,5.47,5.68,5.57,5.79,5.63,5.85,5.53,5.10,5.34)
mean(obs)
sd(obs)
length(obs)
a <- qt(0.975,22)*sd(obs)/sqrt(23)
mean(obs)+a
mean(obs)-a
setwd("/Users/YvonneHuang/program/stat/")
DBH <- read.table("DBH.txt",header=T)
DBH <- unlist(DBH)
DBH
DBH <- DBH$dbh
mean(DBH)
x <- sample(DBH,116,replace=F)
mean(x)
sd(x)
x
setwd("/Users/YvonneHuang/program/stat/")
DBH <- read.table("DBH.txt",header=T)
DBH <- DBH$dbh
DBH
x <- sample(DBH,116,replace=F)
x
mean(x)
sd(x)
a <- qt(0.975,115)*sd(x)/sqrt(116)
mean(x)+a
mean(x)-a
mean(DBH)
